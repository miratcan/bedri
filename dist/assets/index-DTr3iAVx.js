(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const _ of o.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&r(_)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Y,k,we,F,se,ke,xe,Ce,ie,te,ne,R={},Se=[],Le=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Q=Array.isArray;function E(t,e){for(var n in e)t[n]=e[n];return t}function oe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Re(t,e,n){var r,l,o,_={};for(o in e)o=="key"?r=e[o]:o=="ref"?l=e[o]:_[o]=e[o];if(arguments.length>2&&(_.children=arguments.length>3?Y.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)_[o]==null&&(_[o]=t.defaultProps[o]);return B(t,_,r,l,null)}function B(t,e,n,r,l){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++we,__i:-1,__u:0};return l==null&&k.vnode!=null&&k.vnode(o),o}function J(t){return t.children}function j(t,e){this.props=t,this.context=e}function N(t,e){if(e==null)return t.__?N(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?N(t):null}function Ie(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ie(t)}}function ce(t){(!t.__d&&(t.__d=!0)&&F.push(t)&&!X.__r++||se!=k.debounceRendering)&&((se=k.debounceRendering)||ke)(X)}function X(){for(var t,e,n,r,l,o,_,a=1;F.length;)F.length>a&&F.sort(xe),t=F.shift(),a=F.length,t.__d&&(n=void 0,l=(r=(e=t).__v).__e,o=[],_=[],e.__P&&((n=E({},r)).__v=r.__v+1,k.vnode&&k.vnode(n),le(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[l]:null,o,l??N(r),!!(32&r.__u),_),n.__v=r.__v,n.__.__k[n.__i]=n,Pe(o,n,_),n.__e!=l&&Ie(n)));X.__r=0}function De(t,e,n,r,l,o,_,a,c,s,f){var i,d,h,y,S,g,v=r&&r.__k||Se,m=e.length;for(c=Ue(n,e,v,c,m),i=0;i<m;i++)(h=n.__k[i])!=null&&(d=h.__i==-1?R:v[h.__i]||R,h.__i=i,g=le(t,h,d,l,o,_,a,c,s,f),y=h.__e,h.ref&&d.ref!=h.ref&&(d.ref&&_e(d.ref,null,h),f.push(h.ref,h.__c||y,h)),S==null&&y!=null&&(S=y),4&h.__u||d.__k===h.__k?c=ze(h,c,t):typeof h.type=="function"&&g!==void 0?c=g:y&&(c=y.nextSibling),h.__u&=-7);return n.__e=S,c}function Ue(t,e,n,r,l){var o,_,a,c,s,f=n.length,i=f,d=0;for(t.__k=new Array(l),o=0;o<l;o++)(_=e[o])!=null&&typeof _!="boolean"&&typeof _!="function"?(c=o+d,(_=t.__k[o]=typeof _=="string"||typeof _=="number"||typeof _=="bigint"||_.constructor==String?B(null,_,null,null,null):Q(_)?B(J,{children:_},null,null,null):_.constructor==null&&_.__b>0?B(_.type,_.props,_.key,_.ref?_.ref:null,_.__v):_).__=t,_.__b=t.__b+1,a=null,(s=_.__i=Oe(_,n,c,i))!=-1&&(i--,(a=n[s])&&(a.__u|=2)),a==null||a.__v==null?(s==-1&&(l>f?d--:l<f&&d++),typeof _.type!="function"&&(_.__u|=4)):s!=c&&(s==c-1?d--:s==c+1?d++:(s>c?d--:d++,_.__u|=4))):t.__k[o]=null;if(i)for(o=0;o<f;o++)(a=n[o])!=null&&(2&a.__u)==0&&(a.__e==r&&(r=N(a)),$e(a,a));return r}function ze(t,e,n){var r,l;if(typeof t.type=="function"){for(r=t.__k,l=0;r&&l<r.length;l++)r[l]&&(r[l].__=t,e=ze(r[l],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=N(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Oe(t,e,n,r){var l,o,_=t.key,a=t.type,c=e[n];if(c===null&&t.key==null||c&&_==c.key&&a==c.type&&(2&c.__u)==0)return n;if(r>(c!=null&&(2&c.__u)==0?1:0))for(l=n-1,o=n+1;l>=0||o<e.length;){if(l>=0){if((c=e[l])&&(2&c.__u)==0&&_==c.key&&a==c.type)return l;l--}if(o<e.length){if((c=e[o])&&(2&c.__u)==0&&_==c.key&&a==c.type)return o;o++}}return-1}function ue(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Le.test(e)?n:n+"px"}function q(t,e,n,r,l){var o;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||ue(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||ue(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(Ce,"$1")),e=e.toLowerCase()in t||e=="onFocusOut"||e=="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=ie,t.addEventListener(e,o?ne:te,o)):t.removeEventListener(e,o?ne:te,o);else{if(l=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function de(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ie++;else if(e.t<n.u)return;return n(k.event?k.event(e):e)}}}function le(t,e,n,r,l,o,_,a,c,s){var f,i,d,h,y,S,g,v,m,T,P,H,M,Z,p,b,w,C=e.type;if(e.constructor!=null)return null;128&n.__u&&(c=!!(32&n.__u),o=[a=e.__e=n.__e]),(f=k.__b)&&f(e);e:if(typeof C=="function")try{if(v=e.props,m="prototype"in C&&C.prototype.render,T=(f=C.contextType)&&r[f.__c],P=f?T?T.props.value:f.__:r,n.__c?g=(i=e.__c=n.__c).__=i.__E:(m?e.__c=i=new C(v,P):(e.__c=i=new j(v,P),i.constructor=C,i.render=We),T&&T.sub(i),i.props=v,i.state||(i.state={}),i.context=P,i.__n=r,d=i.__d=!0,i.__h=[],i._sb=[]),m&&i.__s==null&&(i.__s=i.state),m&&C.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=E({},i.__s)),E(i.__s,C.getDerivedStateFromProps(v,i.__s))),h=i.props,y=i.state,i.__v=e,d)m&&C.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),m&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(m&&C.getDerivedStateFromProps==null&&v!==h&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(v,P),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(v,i.__s,P)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(i.props=v,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(x){x&&(x.__=e)}),H=0;H<i._sb.length;H++)i.__h.push(i._sb[H]);i._sb=[],i.__h.length&&_.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(v,i.__s,P),m&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(h,y,S)})}if(i.context=P,i.props=v,i.__P=t,i.__e=!1,M=k.__r,Z=0,m){for(i.state=i.__s,i.__d=!1,M&&M(e),f=i.render(i.props,i.state,i.context),p=0;p<i._sb.length;p++)i.__h.push(i._sb[p]);i._sb=[]}else do i.__d=!1,M&&M(e),f=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++Z<25);i.state=i.__s,i.getChildContext!=null&&(r=E(E({},r),i.getChildContext())),m&&!d&&i.getSnapshotBeforeUpdate!=null&&(S=i.getSnapshotBeforeUpdate(h,y)),b=f,f!=null&&f.type===J&&f.key==null&&(b=Ee(f.props.children)),a=De(t,Q(b)?b:[b],e,n,r,l,o,_,a,c,s),i.base=e.__e,e.__u&=-161,i.__h.length&&_.push(i),g&&(i.__E=i.__=null)}catch(x){if(e.__v=null,c||o!=null)if(x.then){for(e.__u|=c?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,e.__e=a}else for(w=o.length;w--;)oe(o[w]);else e.__e=n.__e,e.__k=n.__k;k.__e(x,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=qe(n.__e,e,n,r,l,o,_,c,s);return(f=k.diffed)&&f(e),128&e.__u?void 0:a}function Pe(t,e,n){for(var r=0;r<n.length;r++)_e(n[r],n[++r],n[++r]);k.__c&&k.__c(e,t),t.some(function(l){try{t=l.__h,l.__h=[],t.some(function(o){o.call(l)})}catch(o){k.__e(o,l.__v)}})}function Ee(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Q(t)?t.map(Ee):E({},t)}function qe(t,e,n,r,l,o,_,a,c){var s,f,i,d,h,y,S,g=n.props,v=e.props,m=e.type;if(m=="svg"?l="http://www.w3.org/2000/svg":m=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),o!=null){for(s=0;s<o.length;s++)if((h=o[s])&&"setAttribute"in h==!!m&&(m?h.localName==m:h.nodeType==3)){t=h,o[s]=null;break}}if(t==null){if(m==null)return document.createTextNode(v);t=document.createElementNS(l,m,v.is&&v),a&&(k.__m&&k.__m(e,o),a=!1),o=null}if(m==null)g===v||a&&t.data==v||(t.data=v);else{if(o=o&&Y.call(t.childNodes),g=n.props||R,!a&&o!=null)for(g={},s=0;s<t.attributes.length;s++)g[(h=t.attributes[s]).name]=h.value;for(s in g)if(h=g[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=h;else if(!(s in v)){if(s=="value"&&"defaultValue"in v||s=="checked"&&"defaultChecked"in v)continue;q(t,s,null,h,l)}}for(s in v)h=v[s],s=="children"?d=h:s=="dangerouslySetInnerHTML"?f=h:s=="value"?y=h:s=="checked"?S=h:a&&typeof h!="function"||g[s]===h||q(t,s,h,g[s],l);if(f)a||i&&(f.__html==i.__html||f.__html==t.innerHTML)||(t.innerHTML=f.__html),e.__k=[];else if(i&&(t.innerHTML=""),De(e.type=="template"?t.content:t,Q(d)?d:[d],e,n,r,m=="foreignObject"?"http://www.w3.org/1999/xhtml":l,o,_,o?o[0]:n.__k&&N(n,0),a,c),o!=null)for(s=o.length;s--;)oe(o[s]);a||(s="value",m=="progress"&&y==null?t.removeAttribute("value"):y!=null&&(y!==t[s]||m=="progress"&&!y||m=="option"&&y!=g[s])&&q(t,s,y,g[s],l),s="checked",S!=null&&S!=t[s]&&q(t,s,S,g[s],l))}return t}function _e(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(l){k.__e(l,n)}}function $e(t,e,n){var r,l;if(k.unmount&&k.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||_e(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){k.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(l=0;l<r.length;l++)r[l]&&$e(r[l],e,n||typeof t.type!="function");n||oe(t.__e),t.__c=t.__=t.__e=void 0}function We(t,e,n){return this.constructor(t,n)}function Be(t,e,n){var r,l,o,_;e==document&&(e=document.documentElement),k.__&&k.__(t,e),l=(r=!1)?null:e.__k,o=[],_=[],le(e,t=e.__k=Re(J,null,[t]),l||R,R,e.namespaceURI,l?null:e.firstChild?Y.call(e.childNodes):null,o,l?l.__e:e.firstChild,r,_),Pe(o,t,_)}Y=Se.slice,k={__e:function(t,e,n,r){for(var l,o,_;e=e.__;)if((l=e.__c)&&!l.__)try{if((o=l.constructor)&&o.getDerivedStateFromError!=null&&(l.setState(o.getDerivedStateFromError(t)),_=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(t,r||{}),_=l.__d),_)return l.__E=l}catch(a){t=a}throw t}},we=0,j.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=E({},this.state),typeof t=="function"&&(t=t(E({},n),this.props)),t&&E(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),ce(this))},j.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),ce(this))},j.prototype.render=J,F=[],ke=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xe=function(t,e){return t.__v.__b-e.__v.__b},X.__r=0,Ce=/(PointerCapture)$|Capture$/i,ie=0,te=de(!1),ne=de(!0);var je=0;function u(t,e,n,r,l,o){e||(e={});var _,a,c=e;if("ref"in c)for(a in c={},e)a=="ref"?_=e[a]:c[a]=e[a];var s={type:t,props:c,key:n,ref:_,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--je,__i:-1,__u:0,__source:l,__self:o};if(typeof t=="function"&&(_=t.defaultProps))for(a in _)c[a]===void 0&&(c[a]=_[a]);return k.vnode&&k.vnode(s),s}var U,I,V,fe,K=0,Te=[],D=k,he=D.__b,pe=D.__r,me=D.diffed,ge=D.__c,ve=D.unmount,ye=D.__;function ae(t,e){D.__h&&D.__h(I,t,K||e),K=0;var n=I.__H||(I.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function A(t){return K=1,Ge(Me,t)}function Ge(t,e,n){var r=ae(U++,2);if(r.t=t,!r.__c&&(r.__=[Me(void 0,e),function(a){var c=r.__N?r.__N[0]:r.__[0],s=r.t(c,a);c!==s&&(r.__N=[s,r.__[1]],r.__c.setState({}))}],r.__c=I,!I.__f)){var l=function(a,c,s){if(!r.__c.__H)return!0;var f=r.__c.__H.__.filter(function(d){return!!d.__c});if(f.every(function(d){return!d.__N}))return!o||o.call(this,a,c,s);var i=r.__c.props!==a;return f.forEach(function(d){if(d.__N){var h=d.__[0];d.__=d.__N,d.__N=void 0,h!==d.__[0]&&(i=!0)}}),o&&o.call(this,a,c,s)||i};I.__f=!0;var o=I.shouldComponentUpdate,_=I.componentWillUpdate;I.componentWillUpdate=function(a,c,s){if(this.__e){var f=o;o=void 0,l(a,c,s),o=f}_&&_.call(this,a,c,s)},I.shouldComponentUpdate=l}return r.__N||r.__}function W(t,e){var n=ae(U++,3);!D.__s&&Fe(n.__H,e)&&(n.__=t,n.u=e,I.__H.__h.push(n))}function ee(t){return K=5,Ae(function(){return{current:t}},[])}function Ae(t,e){var n=ae(U++,7);return Fe(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Xe(){for(var t;t=Te.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(G),t.__H.__h.forEach(re),t.__H.__h=[]}catch(e){t.__H.__h=[],D.__e(e,t.__v)}}D.__b=function(t){I=null,he&&he(t)},D.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),ye&&ye(t,e)},D.__r=function(t){pe&&pe(t),U=0;var e=(I=t.__c).__H;e&&(V===I?(e.__h=[],I.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(G),e.__h.forEach(re),e.__h=[],U=0)),V=I},D.diffed=function(t){me&&me(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Te.push(e)!==1&&fe===D.requestAnimationFrame||((fe=D.requestAnimationFrame)||Ke)(Xe)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),V=I=null},D.__c=function(t,e){e.some(function(n){try{n.__h.forEach(G),n.__h=n.__h.filter(function(r){return!r.__||re(r)})}catch(r){e.some(function(l){l.__h&&(l.__h=[])}),e=[],D.__e(r,n.__v)}}),ge&&ge(t,e)},D.unmount=function(t){ve&&ve(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{G(r)}catch(l){e=l}}),n.__H=void 0,e&&D.__e(e,n.__v))};var be=typeof requestAnimationFrame=="function";function Ke(t){var e,n=function(){clearTimeout(r),be&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);be&&(e=requestAnimationFrame(n))}function G(t){var e=I,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),I=e}function re(t){var e=I;t.__c=t.__(),I=e}function Fe(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function Me(t,e){return typeof e=="function"?e(t):e}const Ye=1e6,$=navigator.hardwareConcurrency||4,Qe=["Arial","Times New Roman","Courier New","Georgia","Verdana","Helvetica","Impact","Comic Sans MS"],Je=[{value:"lines",label:"Lines"},{value:"words",label:"Words"}],Ze=`
Lorem ipsum dolor sit amet
consectetur adipiscing elit
sed do eiusmod tempor
incididunt ut labore
et dolore magna aliqua
Ut enim ad minim veniam
quis nostrud exercitation
ullamco laboris nisi
ut aliquip ex ea commodo
consequat Duis aute irure
dolor in reprehenderit
in voluptate velit esse
cillum dolore eu fugiat
nulla pariatur Excepteur
sint occaecat cupidatat
non proident sunt in
culpa qui officia deserunt
mollit anim id est laborum
`.trim();function Ve({inputValues:t,onInputChange:e}){return u("fieldset",{class:"input-group",children:[u("legend",{children:"Font Settings"}),u("p",{class:"fieldset-description",children:"Configure how the text will appear. Adjust the font family, size range, opacity, and whether the text should be bold."}),u("div",{class:"input-wrapper",children:[u("label",{for:"fontFamilyInput",children:"Font Family"}),u("select",{name:"font.family",value:t.font.family,onChange:e,id:"fontFamilyInput",children:Qe.map(n=>u("option",{value:n,children:n},n))})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"minSizeInput",children:"Min Size"}),u("input",{type:"number",name:"font.minSize",value:t.font.minSize,onChange:e,placeholder:"Min Size",id:"minSizeInput"})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"maxSizeInput",children:"Max Size"}),u("input",{type:"number",name:"font.maxSize",value:t.font.maxSize,onChange:e,placeholder:"Max Size",id:"maxSizeInput"})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"opacityInput",children:"Opacity"}),u("input",{type:"number",name:"font.opacity",value:t.font.opacity,step:"0.1",min:"0",max:"1",onChange:e,placeholder:"Opacity",id:"opacityInput"})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"boldInput",children:"Bold"}),u("select",{name:"font.bold",value:t.font.bold,onChange:e,id:"boldInput",children:[u("option",{value:"true",children:"Yes"}),u("option",{value:"false",children:"No"})]})]})]})}const et=(t,e,n)=>{const r=t.getImageData(0,0,e,n).data,l=e*n,o=new Float32Array(l);for(let _=0;_<l;_++){const a=_*4,c=r[a],s=r[a+1],f=r[a+2];o[_]=.299*c+.587*s+.114*f}return o},tt=(t,e,n,r)=>{r.putImageData(t.iData,0,0);const l=n.font.bold?"bold":"normal";r.font=`${l} ${e.size}px ${n.font.family}`,r.fillStyle=e.color,r.textAlign="center",r.textBaseline="middle",r.translate(e.position.x,e.position.y),r.rotate(e.rotation),r.fillText(e.text,0,0),r.rotate(-e.rotation),r.translate(-e.position.x,-e.position.y)};function nt({selectedCanvasRef:t,selectedImage:e,setSelectedImage:n,setCurrentImage:r}){const l=_=>{const a=document.createElement("canvas");a.width=_.width,a.height=_.height;const c=a.getContext("2d",{willReadFrequently:!0});if(!c)return;c.drawImage(_,0,0);const s=et(c,_.width,_.height),f={size:{width:_.width,height:_.height},bArray:s,iData:c.getImageData(0,0,_.width,_.height)};n(f);const i=document.createElement("canvas");i.width=_.width,i.height=_.height;const d=i.getContext("2d",{willReadFrequently:!0});if(!d)return;d.fillStyle="black",d.fillRect(0,0,_.width,_.height);const h={bArray:new Float32Array(_.width*_.height),iData:d.getImageData(0,0,_.width,_.height),size:{width:_.width,height:_.height}};r(h)};return u("div",{class:"image-upload-container",children:[u("input",{type:"file",onChange:_=>{var s;const a=(s=_.target.files)==null?void 0:s[0];if(!a)return;const c=new FileReader;c.onload=f=>{var d;const i=new Image;i.onload=()=>{i.width*i.height>Ye&&alert(`Warning: Image dimensions (${i.width}x${i.height}) exceed recommended size. The app will work slow. Number of pixels: ${i.width*i.height}.`),l(i)},i.src=(d=f.target)==null?void 0:d.result},c.readAsDataURL(a)},accept:"image/*",id:"fileInput",style:"display: none"}),u("button",{onClick:()=>{var _;return(_=document.getElementById("fileInput"))==null?void 0:_.click()},class:"upload-button",children:e?"Change Image":"Select Image"}),u("canvas",{ref:t,id:"selectedCanvas",width:(e==null?void 0:e.size.width)||100,height:(e==null?void 0:e.size.height)||100}),e&&u("div",{class:"image-info",children:u("div",{children:["Dimensions: ",e.size.width,"x",e.size.height,"px"]})})]})}function rt({inputValues:t,onInputChange:e}){return u("fieldset",{class:"input-group",children:[u("legend",{children:"Processing Settings"}),u("p",{class:"fieldset-description",children:"Control how the genetic algorithm works. More iterations will find better placements for each text block, while more generations will add more text blocks to the final image."}),u("div",{class:"input-wrapper",children:[u("label",{for:"iterationsInput",children:"Iterations"}),u("input",{type:"number",name:"iterations",value:t.iterations,onChange:e,placeholder:"Iterations",id:"iterationsInput"})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"generationsInput",children:"Generations"}),u("input",{type:"number",name:"generations",value:t.generations,onChange:e,placeholder:"Number of generations",id:"generationsInput"})]})]})}function it({inputValues:t,onInputChange:e}){return u("fieldset",{class:"input-group",children:[u("legend",{children:"Text Content"}),u("p",{class:"fieldset-description",children:"Enter the text blocks that will be used to draw the image. Each line will be treated as a separate block that can be placed and rotated independently."}),u("div",{class:"input-wrapper",children:[u("label",{for:"useTypeInput",children:"Use"}),u("select",{name:"useType",value:t.useType,onChange:e,id:"useTypeInput",children:Je.map(n=>u("option",{value:n.value,children:n.label},n.value))})]}),u("div",{class:"input-wrapper",children:[u("label",{for:"blocksInput",children:"Text Blocks"}),u("textarea",{name:"blocks",value:t.blocks,onChange:e,placeholder:"Enter text blocks (one per line)",rows:5,id:"blocksInput"})]})]})}function ot({onStart:t,onStop:e,onReset:n,onDownload:r,totalProcessed:l,linesCount:o}){return u("div",{class:"controls",children:[u("button",{onClick:t,children:"Start"}),u("button",{onClick:e,children:"Stop"}),u("button",{onClick:n,children:"Reset"}),u("button",{onClick:r,children:"Download"}),u("progress",{id:"progress",value:l,max:o})]})}function lt(){const[t,e]=A({blocks:Ze,useType:"lines",font:{family:"Arial",minSize:"10",maxSize:"50",opacity:"0.5",bold:"false",shadow:{color:"#000000",blur:"0",offsetX:"0",offsetY:"0",enabled:"false"}},iterations:80,generations:800}),[n,r]=A(!1),[l,o]=A(0),[_,a]=A(),[c,s]=A({}),[f,i]=A(null),[d,h]=A(null),y=ee([]),S=ee(null),g=ee(null);W(()=>{d&&P()},[d]),W(()=>{if(Object.keys(c).length!==$||!g.current||!d||!n)return;if(l+1>=m.generations){r(!1);return}o(x=>x+1);const b=Object.values(c).reduce((x,z)=>!x||(z.score??0)>(x.score??0)?z:x,null);if(!b)return;console.log("Legend for next generation:",JSON.stringify(b));const w=document.createElement("canvas");w.width=d.size.width,w.height=d.size.height;const C=w.getContext("2d",{willReadFrequently:!0});C&&(f?C.putImageData(f.iData,0,0):(C.fillStyle="black",C.fillRect(0,0,w.width,w.height)),tt(f||{iData:C.getImageData(0,0,w.width,w.height),size:{width:w.width,height:w.height}},b,m,C),i({iData:C.getImageData(0,0,w.width,w.height),size:{width:w.width,height:w.height}}));for(let x=0;x<$;x++){const z=y.current[x];if(!z)continue;const O=Math.floor(m.iterations/$)+(x<m.iterations%$?1:0);z.postMessage({action:"enter",workerId:x,timestamp:Date.now(),legend:b,options:m,nofCandidates:O})}s({})},[c]),W(()=>{if(f&&S.current){const p=S.current.getContext("2d",{willReadFrequently:!0});p&&((S.current.width!==f.iData.width||S.current.height!==f.iData.height)&&(S.current.width=f.iData.width,S.current.height=f.iData.height),p.putImageData(f.iData,0,0))}},[f]),W(()=>{if(d&&g.current){const p=g.current.getContext("2d",{willReadFrequently:!0});if(!p)return;(g.current.width!==d.size.width||g.current.height!==d.size.height)&&(g.current.width=d.size.width,g.current.height=d.size.height),p.putImageData(d.iData,0,0)}},[d]);const v=p=>{const b=p.target,w=b.type==="number"?Number(b.value):b.value,[,C,x]=b.name.split(".");e(C&&x?z=>({...z,font:{...z.font,[C]:w}}):C?z=>({...z,font:{...z.font,[C]:w}}):z=>({...z,[b.name]:w}))},m=Ae(()=>({blocks:t.useType==="words"?t.blocks.trim().split(/\s+/):t.blocks.trim().split(/\n+/),font:{family:t.font.family,minSize:parseInt(t.font.minSize),maxSize:parseInt(t.font.maxSize),opacity:parseFloat(t.font.opacity),bold:t.font.bold==="true"},iterations:t.iterations,generations:t.generations}),[t]),T=()=>{if(S.current){const p=document.createElement("a");p.href=S.current.toDataURL("image/png"),p.download="textdraw.png",document.body.appendChild(p),p.click(),document.body.removeChild(p)}},P=()=>{if(d){y.current.forEach(p=>{p&&p.terminate()}),y.current=[];for(let p=0;p<$;p++)try{const b=new Worker(new URL("/assets/arena-BnQIeC3Q.js",import.meta.url),{type:"module"});b.onmessage=w=>{var z;const{action:C,workerId:x}=w.data;if(!("reason"in w.data)&&x!==void 0)switch(C){case"ready":a(L=>({...L??{},[x]:{total:0,processed:0}}));break;case"initialized":n||(z=y.current[x])==null||z.postMessage({action:"battle",timestamp:Date.now(),workerId:x});break;case"update":const O=w.data;a(L=>({...L??{},[x]:{total:O.total,processed:O.processed}}));break;case"done":const Ne=w.data;s(L=>({...L,[x]:Ne.victor.candidate}));break;case"error":break}},b.postMessage({action:"prepare",workerId:p,selectedImage:d,timestamp:Date.now()}),y.current[p]=b}catch{}}};return u("div",{class:"wrapper",children:[u("div",{class:"description",children:u("p",{children:"Upload an image and enter text lines. The app will generate a text-based representation of the image using the provided text."})}),u("div",{class:"row",children:[u("div",{class:"inputs",children:[u(nt,{selectedCanvasRef:g,selectedImage:d,setSelectedImage:h,setCurrentImage:i}),u(it,{inputValues:t,onInputChange:v}),u(Ve,{inputValues:t,onInputChange:v}),u(rt,{inputValues:t,onInputChange:v})]}),u("div",{class:"canvas-container",children:[u("canvas",{ref:S,id:"currentCanvas"}),u(ot,{onStart:()=>{if(!n){if(!d){alert("Please upload an image first.");return}if(!y.current||y.current.length===0){alert("Workers are not initialized yet.");return}if(m.blocks.length===0){alert("Please enter some text first.");return}if(m.font.minSize>=m.font.maxSize){alert("Minimum font size must be less than maximum font size.");return}r(!0),o(0),a({}),s({});for(let p=0;p<$;p++){const b=y.current[p];if(!b)continue;const w=Math.floor(m.iterations/$)+(p<m.iterations%$?1:0);b.postMessage({action:"enter",workerId:p,timestamp:Date.now(),options:m,nofCandidates:w})}}},onStop:()=>{r(!1),y.current.forEach(p=>{p.terminate()}),P()},onReset:()=>{if(r(!1),o(0),a(void 0),s({}),g.current){const p=g.current.getContext("2d",{willReadFrequently:!0});p&&p.clearRect(0,0,g.current.width,g.current.height)}},onDownload:T,totalProcessed:_?Object.values(_).reduce((p,b)=>p+b.processed,0):0,linesCount:_?Object.values(_).reduce((p,b)=>p+b.total,0):0})]})]})]})}Be(u(lt,{}),document.getElementById("app"));
